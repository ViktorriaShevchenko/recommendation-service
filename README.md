#  Recommendation Service

Микросервис для персональных рекомендаций кредитных продуктов на основе анализа транзакций пользователей.

---

##  Функциональность

Сервис анализирует финансовое поведение пользователей и рекомендует подходящие банковские продукты согласно бизнес-правилам.

###  Правила рекомендаций

| Название | ID правила | Условия |
|----------|------------|---------|
| **Invest 500** | `147f6a0f-3b91-413b-ab99-87f081d60d5a` | • Использует продукты типа **DEBIT**<br>• **НЕ** использует продукты типа **INVEST**<br>• Сумма пополнений **SAVING** > 1 000 ₽ |
| **Top Saving** | `59efc529-2fff-41af-baff-90ccd7402925` | • Использует продукты типа **DEBIT**<br>• Сумма пополнений **DEBIT** ≥ 50 000 ₽ **ИЛИ** **SAVING** ≥ 50 000 ₽<br>• Пополнения **DEBIT** > траты **DEBIT** |
| **Простой кредит** | `ab138afb-f3ba-4a93-b74f-0fcee86d447f` | • **НЕ** использует продукты типа **CREDIT**<br>• Пополнения **DEBIT** > траты **DEBIT**<br>• Траты **DEBIT** > 100 000 ₽ |

---

##  Технологический стек

- **Java 17**
- **Spring Boot 3.2.3**
- **Spring Data JDBC** (без JPA/Hibernate)
- **H2 Database** (in-memory для тестов, read-only для транзакций)
- **Maven**
- **JUnit 5** + **Mockito**

---

##  Структура проекта

```
src/main/java/com/starbank/recommendation_service/
├── configuration/          # Конфигурация БД и приложения
├── controller/            # REST API эндпоинты
├── dto/                   # Data Transfer Objects
├── repository/            # Репозитории для работы с БД
├── service/               # Бизнес-логика и правила
└── RecommendationServiceApplication.java
```

---

##  Быстрый старт

### Предварительные требования
- **Java 17** или выше
- **Maven 3.6+**
- Файл базы данных `transaction.mv.db` в корне проекта

### Сборка и запуск

```bash
# Клонирование и переход в директорию проекта
git clone <repository-url>
cd recommendation-service

# Сборка проекта
mvn clean package

# Запуск приложения
java -jar target/recommendation-service-0.0.1-SNAPSHOT.jar

# Или запуск через Maven
mvn spring-boot:run
```

Приложение будет доступно по адресу: **http://localhost:8080**
Важно: Это REST API сервис, а не веб-сайт. После запуска используйте API endpoints, описанные ниже.
---

##  API Endpoints

### Получение рекомендаций для пользователя

**Endpoint:**  
`GET /recommendation/{userId}`

**Пример запроса:**
```bash
curl "http://localhost:8080/recommendation/cd515076-5d8a-44be-930e-8d4fcb79f42d"
```

**Пример успешного ответа (200 OK):**
```json
{
  "user_id": "cd515076-5d8a-44be-930e-8d4fcb79f42d",
  "recommendations": [
    {
      "id": "147f6a0f-3b91-413b-ab99-87f081d60d5a",
      "name": "Invest 500",
      "text": "Откройте свой путь к успеху..."
    }
  ]
}
```

**Ошибка при некорректном UUID (400 Bad Request):**
```bash
curl "http://localhost:8080/recommendation/invalid-uuid"
```

---

##  Тестирование

### Запуск тестов
```bash
# Все тесты
mvn test

# Только unit-тесты
mvn test -Dtest="*UnitTest"

# Только интеграционные тесты
mvn test -Dtest="*IntegrationTest"
```

### Типы тестов
-  **Интеграционные тесты** контроллера
-  **Unit-тесты** с моками (Mockito)
-  **Тесты репозитория** с реальной H2 БД
-  **Тесты бизнес-логики** и правил рекомендаций

---

##  Базы данных

### Основная БД (production)
- **Тип:** Файловая H2
- **Файл:** `transaction.mv.db` (размещается в корне проекта)
- **Режим:** Только для чтения
- **Назначение:** Содержит транзакции пользователей

### Тестовая БД
- **Тип:** H2 in-memory
- **Инициализация:** Автоматическое создание таблиц и тестовых данных
- **Назначение:** Используется исключительно для тестирования

---

##  Команда разработки

| Роль | Разработчик | Область ответственности                               |
|------|-------------|-------------------------------------------------------|
| **Backend разработка** | Шевченко Виктория | Планирование, контроллеры, тестирование, документация |
| **Backend разработка** | Шишкин Денис | Репозитории, бизнес-правила, конфигурация БД          |

---

## Лицензия

Проект разработан в рамках учебного задания. Все права защищены.

---
*Последнее обновление: январь 2026*